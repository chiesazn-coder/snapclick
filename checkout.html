<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Checkout</title>
    <link href="/src/style.css" rel="stylesheet">
  </head>

  <body class="min-h-screen bg-neutral-50 text-neutral-900">
    <!-- Announcement bar -->
    <div class="w-full bg-neutral-900 text-neutral-100 text-center text -sm tracking-wide py-2">
      <span class="inline-flex items-center gap-2">
        <!-- mini store icon -->
        <svg class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
          <path d="M3 9h18l-1.5 10.5a2 2 0 0 1-2 1.5H6.5a2 2 0 0 1-2-1.5L3 9Zm18-2H3l1.8-3.6A2 2 0 0 1 6.6 2h10.8a2 2 0 0 1 1.8 1.4L21 7Z"/>
        </svg>
        <strong class="font-semibold">AUTUMN FLASH SALE!</strong>
        <span> Today only 39% off!</span>
      </span>
    </div>
  
    <!-- Navbar -->
    <header class="sticky top-0 z-50 bg-white/90 backdrop-blur border-b">
      <div class="mx-auto max-w-7xl px-4 py-4 grid grid-cols-3 items-center">
        <!-- Left nav -->
        <nav class="hidden sm:flex items-center gap-6">
          <a href="/index.html" class="font-medium text-neutral-900 hover:text-neutral-700">Home</a>
          <a href="#" class="text-neutral-700 hover:text-neutral-900">Clickclick™</a>
          <a href="#" class="text-neutral-700 hover:text-neutral-900">Contact</a>
        </nav>
  
        <!-- Center logo -->
        <a href="#" class="justify-self-center inline-flex items-center gap-2">
          <!-- simple lotus icon -->
          <span class="text-lg font-semibold tracking-wide">CLICKCLICK</span>
        </a>
  
        <!-- Right icons -->
        <div class="justify-self-end flex items-center gap-5">
          <!-- account -->
          <button class="p-2 rounded-md hover:bg-neutral-100" aria-label="Account">
            <svg class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
              <path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-4.42 0-8 2.24-8 5v1h16v-1c0-2.76-3.58-5-8-5Z"/>
            </svg>
          </button>
          <!-- cart -->
          <button class="p-2 rounded-md hover:bg-neutral-100" aria-label="Cart">
            <svg class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
              <path d="M7 4h-2l-1 2v2h2l3.6 7.59a2 2 0 0 0 1.8 1.18H19v-2h-7.2L12 13h6.55a2 2 0 0 0 1.92-1.46L22 6H6.21"/>
            </svg>
          </button>
        </div>
      </div>
    </header>

    <!-- CHECKOUT SECTION -->
    <section class="mx-auto max-w-7xl px-4 py-10 md:py-14">
        <div class="grid gap-10 lg:grid-cols-2">
    
        <!-- ========== LEFT: GALLERY ========== -->
        <div>
            <!-- Main image -->
            <div class="relative overflow-hidden rounded-2xl ring-1 ring-black/10 shadow-sm">
            <img id="pd-main"
                src="/src/images/products/product-main.png"
                alt="Clickclick Massager"
                class="w-full aspect-square object-cover" />
            </div>
    
            <!-- Thumbnails -->
            <div id="pd-thumbs" class="mt-4 flex gap-3 overflow-x-auto pb-1"></div>

        </div>
    
        <!-- ========== RIGHT: DETAILS ========== -->
        <div class="lg:pl-6">
            <!-- Title -->
            <h1 id="pd-title"
              data-base="Robotic Hand Massager"
              class="text-3xl md:text-4xl font-bold text-neutral-900">
              Robotic Hand Massager Alpine Green
            </h1>

            <!-- Rating + count -->
            <div class="mt-2 flex items-center gap-2 text-sm text-neutral-600">
            <div class="flex items-center text-amber-500">
                <!-- 4.5 stars -->
                <svg class="h-4 w-4 fill-current"><use href="#icon-star"/></svg>
                <svg class="h-4 w-4 fill-current"><use href="#icon-star"/></svg>
                <svg class="h-4 w-4 fill-current"><use href="#icon-star"/></svg>
                <svg class="h-4 w-4 fill-current"><use href="#icon-star"/></svg>
                <svg class="h-4 w-4 fill-current opacity-50"><use href="#icon-star"/></svg>
            </div>
            <span>based on 1,000+ reviews</span>
            </div>
    
            <!-- Price row -->
            <div class="mt-3 flex items-center flex-wrap gap-3">
              <div id="unit-price"
                  class="text-2xl md:text-3xl font-extrabold text-emerald-700"
                  data-price="110" data-currency="$">
                $110
              </div>
            </div>

    
            <!-- Bullets -->
            <ul class="mt-5 space-y-2 text-sm text-neutral-800">
            <li class="flex items-start gap-2">
                <svg class="mt-0.5 h-5 w-5 text-emerald-600"><use href="#icon-check"/></svg>
                <span>Instant Relief</span>
            </li>
            <li class="flex items-start gap-2">
                <svg class="mt-0.5 h-5 w-5 text-emerald-600"><use href="#icon-check"/></svg>
                <span>Smart Heat</span>
            </li>
            <li class="flex items-start gap-2">
                <svg class="mt-0.5 h-5 w-5 text-emerald-600"><use href="#icon-check"/></svg>
                <span>Portable Comfort</span>
            </li>
            <li class="flex items-start gap-2">
                <svg class="mt-0.5 h-5 w-5 text-emerald-600"><use href="#icon-check"/></svg>
                <span>Deep Relaxation</span>
            </li>
            </ul>
    
            <!-- Color selector -->
            <div class="mt-6">
              <div class="text-sm text-neutral-600 mb-2">Color</div>
              <div id="pd-colors" class="flex flex-wrap items-center gap-2">
                <!-- tombol warna (swatch) -->
                <button type="button" class="w-8 h-8 rounded-full border-2 border-emerald-700 bg-emerald-600 data-[active=true]:ring-2 data-[active=true]:ring-emerald-400" aria-label="Alpine Green" data-color="green" data-active="true"></button>
                <button type="button" class="w-8 h-8 rounded-full border-2 border-transparent bg-pink-400 data-[active=true]:ring-2 data-[active=true]:ring-neutral-400" aria-label="Rose Pink" data-color="pink"></button>
                <!-- contoh varian tambahan:
                <button type="button" class="w-8 h-8 rounded-full border-2 border-transparent bg-white data-[active=true]:ring-2 data-[active=true]:ring-neutral-300" aria-label="Pearl White" data-color="white"></button>
                -->
              </div>
            </div>

            <!-- BUNDLE & SAVE -->
            <div class="mt-6">
              <div class="text-xs tracking-wide text-neutral-500 mb-2">BUNDLE &amp; SAVE</div>
              <div class="grid gap-3 sm:grid-cols-2">
                <label class="flex items-start gap-3 rounded-xl border p-4 hover:border-emerald-500 cursor-pointer">
                  <input type="radio" name="bundle" class="mt-1 h-4 w-4 accent-emerald-600"
                        data-qty="1" data-total="110" checked />
                  <div class="flex-1">
                    <div class="font-semibold">Buy 1</div>
                    <div class="text-sm text-neutral-600">
                      $110 <span class="line-through text-neutral-400">$130</span>
                    </div>
                  </div>
                </label>

                <label class="flex items-start gap-3 rounded-xl border p-4 hover:border-emerald-500 cursor-pointer">
                  <input type="radio" name="bundle" class="mt-1 h-4 w-4 accent-emerald-600"
                        data-qty="2" data-total="187" />
                  <div class="flex-1">
                    <div class="font-semibold">Buy 2</div>
                    <div class="text-sm text-neutral-600">
                      $187 <span class="line-through text-neutral-400">$220</span>
                    </div>
                  </div>
                </label>
              </div>
            </div>

            <!-- Countdown -->
            <div class="mt-4 flex items-center gap-2 text-sm">
            <svg class="h-4 w-4 text-rose-600"><use href="#icon-clock"/></svg>
            <span>Sale ending in <span class="font-semibold text-rose-600">00:11:55</span></span>
            </div>
    
            <!-- CTA -->
            <div class="mt-5">
              <button id="buy-btn" class="w-full rounded-lg bg-emerald-700 text-white font-semibold py-4 text-lg hover:bg-emerald-800 shadow-sm">
                ADD TO CART
              </button>
            </div>

            <!-- Quantity & Subtotal -->
            <div class="mt-5 flex items-center justify-between">
              <!-- Quantity control -->
              <div class="flex items-center gap-2">
                <button type="button"
                        id="qty-dec"
                        class="h-9 w-9 rounded-md border hover:bg-neutral-50 flex items-center justify-center"
                        aria-label="Decrease quantity">−</button>
                <input id="qty-input" type="number" inputmode="numeric" min="1" max="99" value="1"
                      class="w-14 h-9 rounded-md border text-center" aria-label="Quantity">
                <button type="button"
                        id="qty-inc"
                        class="h-9 w-9 rounded-md border hover:bg-neutral-50 flex items-center justify-center"
                        aria-label="Increase quantity">+</button>
              </div>

              <!-- Subtotal -->
              <div class="text-right">
                <div class="text-xs text-neutral-500">Subtotal</div>
                <div id="subtotal" class="text-lg font-semibold text-neutral-900">$110</div>
              </div>
            </div>

            <!-- Mini testimonial
            <div class="mt-5 flex items-start gap-3">
            <img src="/src/images/avatar-lucy.jpg" class="h-10 w-10 rounded-full object-cover" alt="Lucy">
            <div class="text-sm">
                <div class="font-medium">So helpful, happy with my purchase!</div>
                <div class="flex items-center gap-1 text-amber-500">
                <svg class="h-3.5 w-3.5 fill-current"><use href="#icon-star"/></svg>
                <svg class="h-3.5 w-3.5 fill-current"><use href="#icon-star"/></svg>
                <svg class="h-3.5 w-3.5 fill-current"><use href="#icon-star"/></svg>
                <svg class="h-3.5 w-3.5 fill-current"><use href="#icon-star"/></svg>
                <svg class="h-3.5 w-3.5 fill-current opacity-70"><use href="#icon-star"/></svg>
                </div>
                <div class="text-neutral-500 text-xs">Lucy</div>
            </div>
            </div>  -->
    
            <!-- Accordions -->
            <div class="mt-6 divide-y rounded-lg border">
            <details class="group open:bg-neutral-50">
                <summary class="flex cursor-pointer items-center justify-between px-4 py-3">
                <span class="font-medium">How It Works</span>
                <svg class="h-4 w-4 transition group-open:rotate-180"><use href="#icon-chevron"/></svg>
                </summary>
                <div class="px-4 pb-4 text-sm text-neutral-600">
                Place on neck/back, choose intensity, enable heat for deeper relief. Use 10–15 minutes per session.
                </div>
            </details>
            <details class="group">
                <summary class="flex cursor-pointer items-center justify-between px-4 py-3">
                <span class="font-medium">Key Features</span>
                <svg class="h-4 w-4 transition group-open:rotate-180"><use href="#icon-chevron"/></svg>
                </summary>
                <div class="px-4 pb-4 text-sm text-neutral-600">
                Deep-tissue kneading, smart heat, portable & rechargeable, breathable fabric, quiet motor.
                </div>
            </details>
            <details class="group">
                <summary class="flex cursor-pointer items-center justify-between px-4 py-3">
                <span class="font-medium">Specifications</span>
                <svg class="h-4 w-4 transition group-open:rotate-180"><use href="#icon-chevron"/></svg>
                </summary>
                <div class="px-4 pb-4 text-sm text-neutral-600">
                5000mAh battery, USB-C, 3 modes, 15×12×9cm, ≤45dB.
                </div>
            </details>
            <details class="group">
                <summary class="flex cursor-pointer items-center justify-between px-4 py-3">
                <span class="font-medium">Shipping & Guarantee</span>
                <svg class="h-4 w-4 transition group-open:rotate-180"><use href="#icon-chevron"/></svg>
                </summary>
                <div class="px-4 pb-4 text-sm text-neutral-600">
                Ships across Indonesia in 2–5 days. 30-day risk-free return & 1-year warranty.
                </div>
            </details>
            </div>
        </div>
        </div>
    </section>
  
    <!-- ===== SVG ICON DEFINITIONS (once per page) ===== -->
    <svg class="hidden">
        <symbol id="icon-star" viewBox="0 0 24 24">
        <path d="M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
        </symbol>
        <symbol id="icon-check" viewBox="0 0 24 24">
        <path fill="currentColor" d="m9 16.2-3.5-3.5L4 14.2 9 19l12-12-1.5-1.5z"/>
        </symbol>
        <symbol id="icon-chevron" viewBox="0 0 24 24">
        <path fill="currentColor" d="m7.41 8.59 4.59 4.59 4.59-4.59L18 10l-6 6-6-6z"/>
        </symbol>
        <symbol id="icon-clock" viewBox="0 0 24 24">
        <path fill="currentColor" d="M12 2a10 10 0 1 0 .001 20.001A10 10 0 0 0 12 2Zm1 11h5v-2h-4V7h-2v6Z"/>
        </symbol>
    </svg>

    <script type="module">
      // ====== ELEMEN & STATE PRODUK PDP ======
      const titleEl = document.getElementById('pd-title');
      const mainImg = document.getElementById('pd-main');
      const thumbs = document.getElementById('pd-thumbs');
      const colorSwatches = document.querySelectorAll('#pd-colors [data-color]');
      const unitEl = document.getElementById('unit-price');
      const qtyInput = document.getElementById('qty-input');
      const incBtn = document.getElementById('qty-inc');
      const decBtn = document.getElementById('qty-dec');
      const subtotalEl = document.getElementById('subtotal');
      const bundleRadios = document.querySelectorAll('input[name="bundle"]');
      const buyBtn = document.getElementById('buy-btn');
    
      // data gambar untuk tiap warna
      const productImages = {
        green: [
          '/src/images/products/green/1.png',
          '/src/images/products/green/2.png',
          '/src/images/products/green/3.png',
          '/src/images/products/green/4.png',
        ],
        pink: [
          '/src/images/products/pink/1.png',
          '/src/images/products/pink/2.png',
          '/src/images/products/pink/3.png',
          '/src/images/products/pink/4.png',
        ],
        // white: [...]
      };
    
      // helper kecil
      function clamp(val, min, max) {
        return Math.max(min, Math.min(max, val));
      }
      function fmt(n) {
        const s = Number(n).toFixed(2);
        return s.endsWith('.00') ? String(Math.round(Number(n))) : s;
      }
    
      // ====== Thumbnail renderer ======
      function renderThumbnails(list) {
        thumbs.innerHTML = '';
        list.forEach((src) => {
          const btn = document.createElement('button');
          btn.className = 'group shrink-0 rounded-xl ring-1 ring-black/10 p-1 focus:outline-none';
          btn.setAttribute('data-src', src);
          btn.innerHTML = `<img src="${src}" class="h-20 w-20 object-cover rounded-lg" alt="">`;
          btn.addEventListener('click', () => {
            mainImg.src = src;
          });
          thumbs.appendChild(btn);
        });
      }
    
      // ====== Warna aktif & update UI warna ======
      function setColor(color) {
        const images = productImages[color];
        if (!images || !images.length) return;
    
        // ganti gambar utama + thumbnails
        mainImg.src = images[0];
        renderThumbnails(images);
    
        // visual "active" di swatch
        colorSwatches.forEach(sw => {
          const active = sw.dataset.color === color;
          sw.dataset.active = active ? 'true' : 'false';
          if (active) {
            sw.classList.add('border-emerald-700');
          } else {
            sw.classList.remove('border-emerald-700');
          }
        });
    
        // ganti nama produk (title)
        const activeSwatch = Array.from(colorSwatches).find(sw => sw.dataset.color === color);
        const colorLabel = activeSwatch?.getAttribute('aria-label') || color;
        const baseName = titleEl.dataset.base || 'Product';
        titleEl.textContent = `${baseName} ${colorLabel}`;
    
        // alt img
        mainImg.alt = `${baseName} ${colorLabel}`;
      }
    
      // klik swatch warna
      colorSwatches.forEach(sw => {
        sw.addEventListener('click', () => setColor(sw.dataset.color));
      });
    
      // init warna default
      const defaultSwatch = Array.from(colorSwatches).find(sw => sw.dataset.active === 'true') || colorSwatches[0];
      setColor(defaultSwatch?.dataset.color || 'green');
    
      // ====== Harga, Qty, Bundle sync ======
      const currency = unitEl?.dataset.currency || '$';
      const unit = Number(unitEl?.dataset.price || 0);
    
      function clearBundleSelection() {
        bundleRadios.forEach(r => (r.checked = false));
      }
    
      function updateSubtotalFromQty() {
        const qty = clamp(Number(qtyInput.value || 1), 1, 99);
        qtyInput.value = qty;
        subtotalEl.textContent = `${currency}${fmt(unit * qty)}`;
      }
    
      function applyBundle(radio) {
        const qty = Number(radio.dataset.qty || 1);
        const total = Number(radio.dataset.total || unit);
        qtyInput.value = clamp(qty, 1, 99);
        subtotalEl.textContent = `${currency}${fmt(total)}`;
      }
    
      // tombol + / -
      incBtn?.addEventListener('click', () => {
        qtyInput.value = clamp(Number(qtyInput.value || 1) + 1, 1, 99);
        clearBundleSelection();
        updateSubtotalFromQty();
      });
      decBtn?.addEventListener('click', () => {
        qtyInput.value = clamp(Number(qtyInput.value || 1) - 1, 1, 99);
        clearBundleSelection();
        updateSubtotalFromQty();
      });
      qtyInput?.addEventListener('input', () => {
        clearBundleSelection();
        updateSubtotalFromQty();
      });
      qtyInput?.addEventListener('blur', updateSubtotalFromQty);
    
      // pilih bundle
      bundleRadios.forEach(r => {
        r.addEventListener('change', () => {
          if (r.checked) applyBundle(r);
        });
      });
    
      // init subtotal
      const defaultBundle = Array.from(bundleRadios).find(r => r.checked);
      defaultBundle ? applyBundle(defaultBundle) : updateSubtotalFromQty();
    
      // helper untuk ambil warna aktif sekarang
      function getActiveColor() {
        const active = Array.from(colorSwatches).find(sw => sw.dataset.active === 'true') || colorSwatches[0];
        return active?.dataset.color || 'green';
      }
      function getActiveColorLabel() {
        const active = Array.from(colorSwatches).find(sw => sw.dataset.active === 'true') || colorSwatches[0];
        return active?.getAttribute('aria-label') || getActiveColor();
      }
      function getUnitPriceNumber() {
        return Number(unitEl?.dataset.price || 0);
      }
      function getEffectiveQtyAndTotal() {
        const defaultBundle = Array.from(bundleRadios).find(r => r.checked);
        if (defaultBundle) {
          return {
            qty: Number(defaultBundle.dataset.qty || '1'),
            total: Number(defaultBundle.dataset.total || getUnitPriceNumber()),
            isBundle: true,
          };
        } else {
          const q = clamp(Number(qtyInput.value || 1), 1, 99);
          return {
            qty: q,
            total: getUnitPriceNumber() * q,
            isBundle: false,
          };
        }
      }
    
      // ====== CART DRAWER STATE ======
      const SHOPIFY_STORE = 'snapclickclick.myshopify.com';
      const VARIANT_BY_COLOR = {
        green: '51550698242342',
        pink:  '51550698275110',
      };
    
      let cartItems = []; // { variantId, title, colorLabel, img, unitPrice, qty }
    
      // drawer elements
      const drawer = document.getElementById('cart-drawer');
      const overlay = document.getElementById('cart-overlay');
      const openBtn = document.getElementById('cart-open-btn'); // NOTE: di checkout.html belum ada tombol ini di navbar. boleh dikosongin.
      const closeBtn = document.getElementById('cart-close-btn');
      const continueBtn = document.getElementById('continue-btn');
      const cartSubtotalEl = document.getElementById('cart-subtotal');
      const cartItemsEl = document.getElementById('cart-items');
      const checkoutBtn = document.getElementById('checkout-btn');
    
      function openCart() {
        drawer.classList.remove('translate-x-full');
        overlay.classList.remove('pointer-events-none');
        requestAnimationFrame(() => {
          overlay.classList.add('opacity-100');
        });
      }
      function closeCart() {
        drawer.classList.add('translate-x-full');
        overlay.classList.add('pointer-events-none');
        overlay.classList.remove('opacity-100');
      }
    
      openBtn?.addEventListener('click', openCart);
      closeBtn?.addEventListener('click', closeCart);
      continueBtn?.addEventListener('click', closeCart);
      overlay?.addEventListener('click', closeCart);
    
      function formatMoney(num) {
        const s = Number(num).toFixed(2);
        return s.endsWith('.00') ? String(Math.round(Number(num))) : s;
      }
    
      function updateSubtotalUI() {
        const subtotal = cartItems.reduce((sum, it) => sum + it.unitPrice * it.qty, 0);
        cartSubtotalEl.textContent = `$${formatMoney(subtotal)}`;
      }
    
      function renderCart() {
        cartItemsEl.innerHTML = '';
    
        cartItems.forEach((item, idx) => {
          const lineTotal = item.unitPrice * item.qty;
    
          const wrapper = document.createElement('div');
          wrapper.className = 'flex gap-4 border-b pb-6';
          wrapper.innerHTML = `
            <div class="h-20 w-20 flex-shrink-0 overflow-hidden rounded-md border">
              <img src="${item.img}"
                   alt="${item.title} - ${item.colorLabel}"
                   class="h-full w-full object-cover">
            </div>
    
            <div class="flex flex-1 flex-col justify-between text-sm">
              <div>
                <div class="flex items-start justify-between gap-2">
                  <div>
                    <h3 class="text-sm font-medium text-neutral-900 leading-tight">
                      ${item.title}
                    </h3>
                    <p class="text-xs text-neutral-500 leading-tight">
                      ${item.colorLabel}
                    </p>
                  </div>
                  <div class="text-sm font-medium text-neutral-900">
                    $${formatMoney(lineTotal)}
                  </div>
                </div>
              </div>
    
              <div class="mt-3 flex items-start justify-between">
                <div class="flex items-center gap-2">
                  <button
                    class="cart-qty-dec h-8 w-8 rounded border flex items-center justify-center text-neutral-700 hover:bg-neutral-50"
                    aria-label="Decrease quantity"
                    data-line="${idx}">−</button>
    
                  <input
                    class="cart-qty-input w-12 h-8 rounded border text-center text-sm"
                    type="number" min="1" max="99" value="${item.qty}"
                    data-line="${idx}" aria-label="Quantity">
    
                  <button
                    class="cart-qty-inc h-8 w-8 rounded border flex items-center justify-center text-neutral-700 hover:bg-neutral-50"
                    aria-label="Increase quantity"
                    data-line="${idx}">+</button>
                </div>
    
                <button
                  class="text-xs text-neutral-500 hover:text-neutral-800"
                  data-remove-line="${idx}">
                  Remove
                </button>
              </div>
            </div>
          `;
    
          cartItemsEl.appendChild(wrapper);
        });
    
        updateSubtotalUI();
      }
    
      // nambah item ke cart dari PDP
      function addToCartFromPDP() {
        const color = getActiveColor();
        const colorLabel = getActiveColorLabel();
        const variantId = VARIANT_BY_COLOR[color];
    
        if (!variantId) {
          alert(`Variant ID Shopify belum diset untuk warna: ${color}`);
          return;
        }
    
        const { qty } = getEffectiveQtyAndTotal();
        const title = titleEl.textContent.trim();
        const imgSrc = mainImg.src;
        const unitPrice = getUnitPriceNumber();
    
        // jika sudah ada variant itu di cart, tambah qty
        const existing = cartItems.find(i => i.variantId === variantId);
        if (existing) {
          existing.qty = clamp(existing.qty + qty, 1, 99);
        } else {
          cartItems.push({
            variantId,
            title,
            colorLabel,
            img: imgSrc,
            unitPrice,
            qty,
          });
        }
    
        renderCart();
        openCart();
      }
    
      // klik ADD TO CART
      buyBtn?.addEventListener('click', (e) => {
        e.preventDefault();
        addToCartFromPDP();
      });
    
      // drawer: qty +/-, remove
      cartItemsEl.addEventListener('click', (e) => {
        if (e.target.classList.contains('cart-qty-inc')) {
          const line = Number(e.target.dataset.line);
          const item = cartItems[line];
          if (!item) return;
          item.qty = clamp(item.qty + 1, 1, 99);
          renderCart();
        }
    
        if (e.target.classList.contains('cart-qty-dec')) {
          const line = Number(e.target.dataset.line);
          const item = cartItems[line];
          if (!item) return;
          item.qty = clamp(item.qty - 1, 1, 99);
          renderCart();
        }
    
        if (e.target.matches('[data-remove-line]')) {
          const line = Number(e.target.getAttribute('data-remove-line'));
          cartItems.splice(line, 1);
          renderCart();
        }
      });
    
      cartItemsEl.addEventListener('input', (e) => {
        if (e.target.classList.contains('cart-qty-input')) {
          const line = Number(e.target.dataset.line);
          const item = cartItems[line];
          if (!item) return;
          let v = Number(e.target.value || 1);
          if (isNaN(v)) v = 1;
          v = clamp(v, 1, 99);
          item.qty = v;
          renderCart();
        }
      });
    
      // checkout → build URL Shopify /cart/<variant:qty>,<variant:qty>
      checkoutBtn?.addEventListener('click', () => {
        if (!cartItems.length) {
          alert('Your cart is empty.');
          return;
        }
        const parts = cartItems.map(it => `${it.variantId}:${it.qty}`);
        const cartUrl = `https://${SHOPIFY_STORE}/cart/${parts.join(',')}`;
        window.location.href = cartUrl;
      });
    
      // initial render (cart kosong)
      renderCart();
    </script>
    
    
    <!-- (opsional) Section berikutnya -->
    <main id="shop" class="mx-auto max-w-7xl px-4 py-12">
      <!-- taruh grid produkmu di sini -->
    </main>

    <!-- BACKDROP -->
    <div id="cart-overlay"
    class="fixed inset-0 bg-black/50 opacity-0 pointer-events-none transition-opacity duration-200 z-[80]"></div>

    <!-- CART DRAWER -->
    <aside id="cart-drawer"
      class="fixed right-0 top-0 h-full w-full max-w-md bg-white shadow-xl z-[90] translate-x-full transition-transform duration-200 flex flex-col">

      <!-- HEADER -->
      <header class="flex items-center justify-between border-b px-6 py-4">
      <h2 class="text-lg font-semibold text-neutral-900">Your cart</h2>
      <button id="cart-close-btn"
      class="p-2 rounded-md hover:bg-neutral-100 text-neutral-500"
      aria-label="Close cart">
      <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor"
        stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
        <path d="M18 6 6 18M6 6l12 12"/>
      </svg>
      </button>
      </header>

      <!-- LINE ITEMS -->
      <div id="cart-items" class="flex-1 overflow-y-auto px-6 py-4 space-y-6 text-sm">
      <!-- item akan di-render via JS -->
      </div>

      <!-- FOOTER -->
      <div class="border-t px-6 py-6">
        <div class="flex items-center justify-between text-sm">
        <span class="text-neutral-600">Subtotal</span>
        <span id="cart-subtotal" class="text-base font-semibold text-neutral-900">
          $0
        </span>
        </div>

        <p class="mt-2 text-xs text-neutral-500 leading-relaxed">
        Taxes and shipping calculated at checkout.
        </p>

        <button id="checkout-btn"
        class="mt-4 w-full rounded-md bg-neutral-900 text-white text-sm font-medium py-3 hover:bg-neutral-800">
        Check out
        </button>

        <button id="continue-btn"
        class="mt-3 w-full text-center text-sm text-neutral-700 underline underline-offset-2 hover:text-neutral-900">
        Continue shopping
        </button>
      </div>
    </aside>

    <footer class="border-t">
      <div class="mx-auto max-w-7xl px-4 py-8 text-sm text-neutral-500">
        © <span id="y"></span> clickclick
      </div>
    </footer>
  
    <script type="module" src="/src/main.js"></script>
    <script>document.getElementById('y').textContent = new Date().getFullYear()</script>
    
  </body>
  
</html>
